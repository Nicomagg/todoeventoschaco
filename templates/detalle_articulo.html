{% extends "main.html" %}

{% block title %}
    {{ articulo.nombre }} | Todo Eventos Chaco
{% endblock %}

{% block head_m %}
	<script src='{{ STATIC_URL }}lightbox2/js/lightbox.js'></script>
    <link rel="stylesheet" href="{{ STATIC_URL }}lightbox2/css/lightbox.css">
	<script>

		$(document).ready(function(){

			// Cargar la portada del album (si es una foto)

			var albumid = "{{ articulo.url_del_album }}".split('.')[3];

			var images = $(document.images)
			$.each(images, function(idx, img){
				if (img.hasAttribute('data-fbalbum-url')){
					
					$.getJSON("https://graph.facebook.com/" + albumid, function(data){
						cover = data['cover_photo'];
						$.getJSON("https://graph.facebook.com/" + cover, function(data){
							img.src = data['images'][3]['source'];
						});
					});
				}
			});


			// Cargar fotos del album
			$.getJSON("https://graph.facebook.com/" + albumid + "/photos", function(data){
				$.each(data['data'], function(idx, img){
					var newimg = $('<div><div>');
					var newlink = $('<a></a>');

					newlink.attr('href', img.images[0].source);
					newlink.attr('rel', 'lightbox['+ albumid +']');

					newimg.addClass('img');
					newimg.css('background-image', 'url("'+ img.images[6].source +'")');

					newlink.append(newimg);
					$('#galeria').append(newlink);
				});
			});


		});
	</script>
{% endblock %}


{% block content %}
		<div class="columna principal">
			<div class="detalle-articulo bloque">
				<div class="columna-interna izquierda">
					<img class='portada' data-fbalbum-url="{{ articulo.url_del_album }}">
				</div>
				<div class="columna-interna derecha">
					<h1>{{ articulo.nombre }}</h1>
					<p>{{ articulo.descripcion }}</p>
				</div>
			</div>
			<div id='galeria' class="galeria bloque">

			</div>
		</div>

		<div class="columna derecha">
			{% ifnotequal p_v|length 0 %}
				<div class="publicidad bloque">
					<img src="{{ p_v.0.url_imagen_publicidad }}" alt="">
					{{ p_v.pop.0 }}
				</div>
			{% endifnotequal %}
		</div>
{% endblock %}